<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TERMINAL // START</title>
    <link rel="icon" type="image/png" href="images/plxeyestiny.png">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    
    <style>
        /* --- GLOBAL UI & CURSORS --- */
        * { cursor: url('images/cursor.png'), auto !important; }
        *:active { cursor: url('images/cursor-click.png'), auto !important; }

        a, button, .suggestion-item, #drawer-tab, select, .handle, .toggle-btn, .link-card, .link-card *, .clear-btn {
            cursor: url('images/link-select.png'), pointer !important;
        }
        a:active, button:active, .suggestion-item:active, #drawer-tab:active, select:active, .link-card:active, .clear-btn:active {
            cursor: url('images/link-select-click.png'), pointer !important;
        }

        /* --- CUSTOM SCROLLBARS --- */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #000; border-left: 1px solid #111; }
        ::-webkit-scrollbar-thumb { background: #333; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

        body {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; margin: 0; overflow: hidden; background: black;
        }
        body.low-power { filter: brightness(0.7); }

        /* --- COMMAND CENTER --- */
        .command-center {
            width: 100%; display: flex; flex-direction: column; align-items: center;
            margin-bottom: 20px;
        }

        .terminal-clock { font-family: 'PixeloidSansBold', sans-serif; font-size: 3.5rem; color: white; margin-bottom: 0px; letter-spacing: 2px; text-shadow: 0 0 10px rgba(255,255,255,0.1); }
        #greeting { font-family: 'PixeloidSansBold', sans-serif; color: #444; margin-bottom: 25px; font-size: 0.8rem; letter-spacing: 4px; text-transform: uppercase; }

        /* --- ANIMATED SEARCH BAR --- */
        .search-wrapper { 
            position: relative; 
            width: 100%; 
            max-width: 650px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            transition: max-width 0.3s cubic-bezier(0.25, 1, 0.5, 1); 
            margin: 0 auto;
        }
        
        .search-wrapper.has-text { max-width: 718px; }

        .search-wrapper::before {
            content: '>'; position: absolute; left: 25px; top: 50%; transform: translateY(-50%);
            color: #fff; font-family: 'PixeloidSansBold', sans-serif; font-size: 1.5rem; z-index: 5;
            animation: blink 1s infinite; text-shadow: 0 0 5px rgba(255,255,255,0.3);
            pointer-events: none;
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        .search-box-container {
            position: relative;
            flex: 0 0 650px;
            height: 60px;
            z-index: 10; /* Keep bar above the sliding suggestions */
        }

        .search-box { 
            width: 100%;
            height: 100%;
            background: #050505; border: 2px solid #222; color: white; 
            font-family: 'PixeloidSans', sans-serif; font-size: 1.3rem; 
            padding: 0 20px 0 50px; 
            outline: none; text-align: left; box-sizing: border-box; 
            transition: border-color 0.2s, background-color 0.2s, box-shadow 0.2s; 
            box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.02);
            background-image: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.02), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.02));
            background-size: 100% 4px, 3px 100%;
            cursor: text !important;
        }
        
        .search-box.flicker {
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.4), inset 0 0 20px rgba(255, 255, 255, 0.2) !important;
            border-color: #fff !important;
        }

        .search-box:focus { 
            border-color: #fff; background-color: #0a0a0a; 
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.15), inset 0 0 15px rgba(255,255,255,0.05); 
        }

        /* --- THE DETACHED "X" BOX --- */
        .clear-btn {
            width: 0px; height: 60px; 
            flex-shrink: 0; 
            background: #000; 
            border: 2px solid transparent; 
            color: #f00; 
            font-family: 'PixeloidSansBold', sans-serif; font-size: 1.4rem; 
            display: flex; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; overflow: hidden;
            transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
            box-sizing: border-box; padding: 0; margin: 0;
            cursor: pointer;
            line-height: 1;
        }
        
        .clear-btn::before, .clear-btn::after { content: none !important; display: none !important; }
        
        .search-wrapper.has-text .clear-btn {
            width: 60px; 
            margin-left: 8px; 
            border-color: #f00; 
            opacity: 1; pointer-events: auto;
        }
        
        .clear-btn:hover { 
            background: #f00 !important; 
            color: #000 !important; 
            border-color: #f00 !important;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.6);
        }

        /* --- PREDICTIVE SEARCH SLIDE ANIMATION --- */
        #suggestions-box {
            position: absolute; 
            top: 100%; 
            left: 0; 
            width: 100%; 
            background: #050505; 
            border: 2px solid #fff; 
            border-top: none; 
            display: flex; /* Always flex but hidden via transform */
            flex-direction: column; 
            z-index: -1; /* Sits behind the search box for the slide effect */
            box-sizing: border-box;
            box-shadow: 0 10px 20px rgba(0,0,0,0.8);
            
            /* Slide Logic */
            transform-origin: top;
            transform: translateY(-100%); 
            opacity: 0;
            transition: transform 0.3s cubic-bezier(0.25, 1, 0.5, 1), opacity 0.2s ease-in-out;
            pointer-events: none;
        }

        #suggestions-box.visible {
            transform: translateY(0);
            opacity: 1;
            pointer-events: auto;
        }

        .suggestion-item {
            padding: 15px 25px; color: #ccc; font-family: 'PixeloidSans', sans-serif; font-size: 1rem;
            border-bottom: 1px solid #111; transition: 0.1s; display: flex; align-items: center;
        }
        .suggestion-item:last-child { border-bottom: none; }
        .suggestion-item:hover { background: #1a1a1a; color: #fff; padding-left: 35px; }

        /* --- REST OF UI --- */
        .quick-links { display: flex; gap: 30px; flex-wrap: wrap; justify-content: center; max-width: 800px; }
        .link-card { display: flex; flex-direction: column; align-items: center; gap: 10px; text-decoration: none; width: 80px; transition: transform 0.1s; }
        .link-card:hover { transform: scale(1.1); }
        .icon-box { width: 54px; height: 54px; background: #111; border: 2px solid #333; display: flex; align-items: center; justify-content: center; transition: 0.2s; box-sizing: border-box; }
        .link-card:hover .icon-box { border-color: white; box-shadow: 0 0 15px rgba(255,255,255,0.1); }
        .icon-box img { width: 32px; height: 32px; image-rendering: pixelated; pointer-events: none; }
        .link-label { color: #444; font-family: 'PixeloidSansBold', sans-serif; font-size: 0.65rem; text-transform: uppercase; letter-spacing: 1px; transition: color 0.2s; text-align: center; width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .link-card:hover .link-label { color: white; }

        .status-bar { position: fixed; bottom: 20px; left: 30px; font-family: 'PixeloidSansBold', sans-serif; font-size: 0.85rem; color: #444; letter-spacing: 2px; text-transform: uppercase; display: flex; align-items: center; gap: 15px; z-index: 5; }
        .weather-module { display: flex; align-items: center; gap: 10px; color: #666; }
        .weather-icon { width: 24px; height: 24px; image-rendering: pixelated; }
        #temp-val { color: #888; }
    </style>
</head>
<body>

    <div id="settings-drawer" style="position: fixed; top: 0; right: -350px; width: 350px; height: 100vh; background: #000; border-left: 2px solid #333; z-index: 100; transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1); color: white; font-family: 'PixeloidSans', sans-serif; display: flex; flex-direction: column;">
        <div id="drawer-tab" style="position: absolute; left: -52px; bottom: 40px; width: 50px; height: 50px; background: #000; border: 2px solid #333; border-right: none; display: flex; align-items: center; justify-content: center;">
            <img src="images/gear.png" id="gear-icon" style="width: 36px; height: 36px; pointer-events: none; transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1);">
        </div>
        <div class="drawer-content" style="padding: 25px; flex-grow: 1; overflow-y: auto;">
            <div class="drawer-header" style="font-family: 'PixeloidSansBold', sans-serif; color: white; margin-bottom: 25px; font-size: 1.1rem; border-bottom: 1px solid #222; padding-bottom: 10px; letter-spacing: 2px;">CORE_SYSTEM</div>
            <div class="setting-section" style="margin-bottom: 30px;">
                <span style="display: block; font-family: 'PixeloidSansBold', sans-serif; font-size: 0.7rem; color: #555; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1.5px;">Search Config</span>
                <select id="engine-select" style="background: #080808; border: 1px solid #333; color: #ccc; padding: 0 10px; height: 36px; box-sizing: border-box; font-family: 'PixeloidSans', sans-serif; width: 100%; outline: none; font-size: 0.8rem;">
                    <option value="duckduckgo">DuckDuckGo</option>
                    <option value="google">Google</option>
                    <option value="youtube">YouTube</option>
                </select>
            </div>
            <div class="setting-section" style="margin-bottom: 30px;">
                <span style="display: block; font-family: 'PixeloidSansBold', sans-serif; font-size: 0.7rem; color: #555; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1.5px;">Link Manager</span>
                <div id="manager-list"></div>
                <button id="addNewBtn" style="width: 100%; background: #000; color: #fff; border: 1px solid #333; height: 36px; box-sizing: border-box; font-family: 'PixeloidSansBold', sans-serif; margin-top: 5px; cursor: pointer;">+ ADD NEW_ENTRY</button>
            </div>
        </div>
    </div>

    <div class="command-center">
        <div id="clock" class="terminal-clock">00:00:00</div>
        <div id="greeting">SYSTEM_ONLINE</div>
        
        <div class="search-wrapper" id="search-wrapper">
            <div class="search-box-container">
                <input type="text" id="web-search" class="search-box" placeholder="type command..." autofocus autocomplete="off">
                <div id="suggestions-box"></div>
            </div>
            <button id="clear-search" class="clear-btn">X</button>
        </div>
    </div>

    <div id="links-container" class="quick-links"></div>

    <div class="status-bar" id="status-bar">
        <span>MIKEVOID_OS</span>
        <span>//</span>
        <div class="weather-module" id="weather-display">
            <img src="images/sunny.png" class="weather-icon" id="weather-img">
            <span id="temp-val">LOADING...</span>
        </div>
        <span>//</span>
        <span id="sys-status">STATUS: NOMINAL</span>
    </div>

    <script>
        const DEFAULT_CONFIG = { showStatus: true, lowPower: false, engine: "duckduckgo", links: [{name: "HUB", url: "/blog/"}, {name: "YOUTUBE", url: "https://youtube.com"}] };
        let config = JSON.parse(localStorage.getItem('startConfig')) || DEFAULT_CONFIG;
        const saveConfig = () => localStorage.setItem('startConfig', JSON.stringify(config));

        const audioAssets = {
            hover: new Audio('sounds/hoverbutton.wav'), 
            click: new Audio('sounds/buttonclick.mp3'),
            types: [new Audio('sounds/type1.mp3'), new Audio('sounds/type2.mp3'), new Audio('sounds/type3.mp3'), new Audio('sounds/type4.mp3')],
            mouseDown: [new Audio('sounds/mousedown1.mp3'), new Audio('sounds/mousedown2.mp3'), new Audio('sounds/mousedown3.mp3'), new Audio('sounds/mousedown4.mp3')],
            mouseUp: [new Audio('sounds/mouseup1.mp3'), new Audio('sounds/mouseup2.mp3'), new Audio('sounds/mouseup3.mp3'), new Audio('sounds/mouseup4.mp3')]
        };

        const playSound = (type) => {
            let sound, vol = 0.4;
            if (type === 'hover') sound = audioAssets.hover;
            else if (type === 'click') sound = audioAssets.click;
            else if (type === 'mouseDown') sound = audioAssets.mouseDown[Math.floor(Math.random() * 4)], vol = 0.05;
            else if (type === 'mouseUp') sound = audioAssets.mouseUp[Math.floor(Math.random() * 4)], vol = 0.05;
            else sound = audioAssets.types[Math.floor(Math.random() * 4)];
            if (sound) { const clone = sound.cloneNode(); clone.volume = vol; clone.play().catch(()=>{}); }
        };

        async function fetchWeather() {
            try {
                const ipRes = await fetch("https://ipapi.co/json/");
                const location = await ipRes.json();
                const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${location.latitude}&longitude=${location.longitude}&current=temperature_2m,weather_code&temperature_unit=fahrenheit`);
                const data = await res.json();
                document.getElementById('temp-val').innerText = `${Math.round(data.current.temperature_2m)}Â°F`;
                let icon = data.current.weather_code === 0 ? "sunny.png" : "cloudy.png";
                document.getElementById('weather-img').src = `images/${icon}`;
            } catch (e) { document.getElementById('temp-val').innerText = "ERROR"; }
        }

        function renderLinks() {
            const container = document.getElementById('links-container');
            container.innerHTML = '';
            config.links.forEach((link) => {
                const card = document.createElement('a');
                card.className = 'link-card'; card.href = link.url; card.target = "_blank";
                card.innerHTML = `<div class="icon-box"><img src="https://www.google.com/s2/favicons?domain=${new URL(link.url).hostname}&sz=64"></div><div class="link-label">${link.name}</div>`;
                card.onmouseenter = () => playSound('hover'); card.onclick = () => playSound('click');
                container.appendChild(card);
            });
        }

        const searchInput = document.getElementById('web-search');
        const clearBtn = document.getElementById('clear-search');
        const searchWrapper = document.getElementById('search-wrapper');
        const suggestionsBox = document.getElementById('suggestions-box');
        let debounceTimer;

        searchInput.addEventListener('focus', () => {
            searchInput.classList.add('flicker');
            setTimeout(() => searchInput.classList.remove('flicker'), 200);
        });

        clearBtn.onmousedown = (e) => {
            e.preventDefault(); 
            playSound('click');
            searchInput.value = '';
            searchWrapper.classList.remove('has-text'); 
            suggestionsBox.classList.remove('visible');
            searchInput.focus();
        };

        window.addEventListener('keydown', (e) => {
            if (e.repeat) return;
            if (e.key === 'Escape') {
                searchInput.value = '';
                searchWrapper.classList.remove('has-text');
                suggestionsBox.classList.remove('visible');
                searchInput.blur();
            }
            if (e.key.length === 1 && document.activeElement !== searchInput) searchInput.focus();
            if (e.key.length === 1 || e.key === 'Backspace') playSound('type');
        });

        searchInput.oninput = () => {
            const query = searchInput.value.trim();
            if (query.length > 0) searchWrapper.classList.add('has-text');
            else {
                searchWrapper.classList.remove('has-text');
                suggestionsBox.classList.remove('visible');
            }

            if (query.length === 0 || query.includes(' ')) { suggestionsBox.classList.remove('visible'); return; }
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(() => {
                const script = document.createElement('script');
                script.src = `https://duckduckgo.com/ac/?q=${encodeURIComponent(query)}&callback=autocompleteCallback`;
                document.body.appendChild(script);
            }, 150);
        };

        window.autocompleteCallback = (data) => {
            if (searchInput.value.trim().length === 0) return;
            suggestionsBox.innerHTML = '';
            if (data && data.length > 0) {
                data.slice(0, 5).forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item'; div.innerText = item.phrase;
                    div.onclick = () => {
                        window.location.href = `https://duckduckgo.com/?q=${encodeURIComponent(item.phrase)}`;
                    };
                    suggestionsBox.appendChild(div);
                });
                suggestionsBox.classList.add('visible');
            } else suggestionsBox.classList.remove('visible');
        };

        const drawer = document.getElementById('settings-drawer');
        const gearIcon = document.getElementById('gear-icon');
        document.getElementById('drawer-tab').onclick = (e) => {
            e.stopPropagation();
            playSound('click');
            const isOpen = drawer.style.right === '0px';
            drawer.style.right = isOpen ? '-350px' : '0px';
            gearIcon.style.transform = isOpen ? 'rotate(0deg)' : 'rotate(180deg)';
        };

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString();
        }

        setInterval(updateClock, 1000);
        renderLinks();
        fetchWeather();
    </script>
</body>
</html>